# orenji_bot

æœ¬ä»“åº“ä¸ºé‡äº§å‹ğŸŠçš„ä»£ç ä»“åº“ã€‚åŠŸèƒ½ä½¿ç”¨äº†[Mirai](https://github.com/mamoe/mirai)ã€[Graia](https://github.com/GraiaProject/)ç­‰æ¡†æ¶å®ç°ã€‚

## æ›´æ–°å†…å®¹
- 2022-3-2æ›´æ–°ï¼š
  - æ›´æ–°äº†graiaç›¸å…³åº“ï¼Œç°åœ¨ä¸º[graia-saya](https://github.com/GraiaProject/Saya)ç®¡ç†moduleï¼Œ[graia-ariadne](https://github.com/GraiaProject/Ariadne/)ä½œä¸ºä¸»æ¡†æ¶ã€‚
  - å¢åŠ äº†æ–°åŠŸèƒ½ï¼š`å›¾ç‰‡è¶…åˆ†è¾¨ç‡(2x super resolution)`ã€‚åœ¨ç¾¤é‡Œå›å¤ä¸€æ¡å¸¦å›¾ç‰‡çš„æ¶ˆæ¯å¹¶è¾“å…¥â€œ2xâ€å³å¯è°ƒç”¨æ­¤åŠŸèƒ½ã€‚æ­¤åŠŸèƒ½ä¾èµ–æˆ‘çš„è¶…åˆ†è¾¨ç‡httpæœåŠ¡ï¼š[sr-orenji](http://sr-orenji.ml:6990/)(å…·ä½“è¯·è§æ­¤ä»“åº“ edit later)ã€‚
- 2021-12-29æ›´æ–°ï¼š
  - æ ‡æ³¨äº†æ‰€æœ‰æ•°æ®ï¼Œå¹³è¡¡åçš„æ•°æ®é›†å…±1200æ¡ã€‚æ”¹ç”¨bert-base-chineseä»£æ›¿albertï¼Œç²¾åº¦ä¸º93.81%ã€‚å·²å°†è¯¥æ¨¡å‹æ›´æ–°éƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚
- 2021-12-28æ›´æ–°ï¼š
  - æ¸…æ´—+æ ‡æ³¨äº†1700æ¡ä»ç¾¤èŠä¸­æ”¶é›†çš„æ•°æ®å¹¶finetuneäº†æ¨¡å‹ã€‚rawåˆ†å¸ƒï¼šçš„:åœ°:å¾—=1400:86:219ï¼Œ`çš„`å æ€»æ•°æ®çš„82%ã€‚ä»ä¸­ä»¥å¤§çº¦1:0.5:1çš„æ¯”ä¾‹é‡‡æ ·äº†500æ¡ä½œä¸ºdatasetã€‚é¢„è®­ç»ƒæƒé‡åŠ è½½è‡ªhuggface/albert_chinese_largeï¼Œfinetuneå…±50epochã€‚eval setæ¯”ä¾‹ä¸º10%ï¼Œæœ€ç»ˆaccä¸º90.91%ã€‚~~å·²å°†è¯¥æ¨¡å‹æ›´æ–°éƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚~~


## åŠŸèƒ½
1. çš„åœ°å¾—å°è­¦å¯Ÿ `modules/dedide_police.py`ï¼šæ£€æµ‹ç¾¤æ¶ˆæ¯ä¸­è¯¯ç”¨çš„â€œçš„åœ°å¾—â€ï¼Œå¹¶å‘æ¶ˆæ¯atè¯¥ç¾¤å‹æå‡ºä¿®æ”¹æ–¹æ¡ˆã€‚
    - ä¸»è¦ä½¿ç”¨`AlbertForMaskedLM`æ¨¡å‹çš„é¢„æµ‹æ¥åˆ¤æ–­ä½¿ç”¨æ˜¯å¦æ­£ç¡®ã€‚ä¾‹å¦‚ï¼šæ¶ˆæ¯`é¦™çš„ä¸€åŒ¹`ï¼ˆ`çš„`ç”¨é”™ï¼Œåº”ä¸º`å¾—`ï¼‰ä¼šè¢«å¤„ç†ä¸º`é¦™[MASK]ä¸€åŒ¹`åè¾“å…¥`AlbertForMaskedLM`ï¼Œç»è¿‡è®¡ç®—åå–`[MASK]`ä½ç½®çš„probability distributionä¸­çš„åœ°å¾—ä¸‰ä¸ªå­—çš„æ¦‚ç‡`{'çš„':0.1, 'å¾—':0.7, 'åœ°':0.05}`ï¼Œæ¯”è¾ƒæœ€é«˜æ¦‚ç‡deæ˜¯å¦ä¸è¾“å…¥ä¸­çš„deä¸€è‡´ã€‚å› æ¦‚ç‡æœ€é«˜è€…ä¸º`å¾—`ï¼Œæ‰€ä»¥å°è­¦å¯Ÿä¼šå‘é€ç¾¤æ¶ˆæ¯`@ç¾¤å‹ çš„->å¾—`ã€‚ç›¸å…³åº“ä¸æ¡†æ¶ï¼š[pytorch](https://github.com/pytorch/pytorch), [transformers](https://github.com/huggingface/transformers), [albert_zh](https://github.com/brightmart/albert_zh).
    - ä¸ºä»€ä¹ˆä¸å…¬å¼€æ•°æ®é›†ï¼Ÿå› ä¸ºæ˜¯ä»ç¾¤å†…æ”¶é›†ï¼Œå«ç¾¤å‹éšç§ã€‚æœªæ¥å¯¹æ•°æ®è„±æ•å¤„ç†åæœ‰å¯èƒ½å…¬å¼€ã€‚
    - ~~[jieba](https://github.com/fxsjy/jieba)~~åˆ†è¯ç”¨äºåˆ¤æ–­å“ª~~äº›çš„åœ°å¾—æ˜¯å•ç‹¬çš„å­—ã€‚å­˜åœ¨äºè¯ç»„ä¸­çš„çš„åœ°å¾—ä¸å±äºæ£€æµ‹èŒƒç•´ã€‚æœ¬é¡¹ç›®ä½¿ç”¨jiebaçš„è‡ªå®šä¹‰è¯å…¸æ¥å±è”½æˆè¯­ï¼ˆå¦‚`ä¼—çŸ¢ä¹‹çš„`ï¼‰å’Œå®¹æ˜“å¼•èµ·æ··æ·†çš„å¸¸ç”¨è¯ï¼ˆå¦‚`çš„å¢é©¬`ã€`çš„åœ°å¾—`ï¼‰ã€‚~~
    - ä¾‹ï¼š![Alt text](images/dedide_example.png?raw=true "dedide_example")

2. å›¾ç‰‡è¶…åˆ†è¾¨ç‡ `modules/super_resolution.py`ï¼šåœ¨ç¾¤é‡Œå›å¤ä¸€æ¡å¸¦å›¾ç‰‡çš„æ¶ˆæ¯å¹¶è¾“å…¥â€œ2xâ€å³å¯è·å¾—è¯¥å›¾ç‰‡é•¿å’Œå®½åˆ†åˆ«æ— æŸï¼ˆå°½é‡ï¼‰\*2çš„ç‰ˆæœ¬ã€‚å¦‚å¯¹ä¸€å¼ `1920*1080`çš„å›¾ç‰‡è¶…åˆ†è¾¨ç‡ï¼Œç»“æœå°†ä¼šæ˜¯ `3840*2160`ã€‚
    - æµç¨‹ï¼šæ”¶åˆ°ç¾¤æ¶ˆæ¯->åˆ¤æ–­æ˜¯å¦ä¸ºå½¢å¦‚â€œ@123 2xâ€çš„è¶…åˆ†è¾¨ç‡å‘½ä»¤->åˆ¤æ–­è¯¥æ¶ˆæ¯æ˜¯å¦å›å¤äº†å…¶ä»–æ¶ˆæ¯->è·å–åŸæ¶ˆæ¯å›¾ç‰‡->è°ƒç”¨è¶…åˆ†è¾¨ç‡æœåŠ¡[sr-orenji](http://sr-orenji.ml:6990/)ï¼Œæäº¤ä»»åŠ¡->æ¯1ç§’æ£€æŸ¥ä»»åŠ¡ç»“æœ->ä»»åŠ¡å®Œæˆï¼Œæ”¶åˆ°2å€ç‰ˆæœ¬ï¼Œå‘åˆ°ç¾¤é‡Œ
    - æ¨¡å‹ï¼š[Real-CUGAN](https://github.com/bilibili/ailab/tree/main/Real-CUGAN) by bilibili-ailabã€‚ä½¿ç”¨äº†`up2x-latest-no-denoise.pth`çš„weightsï¼Œ`tile_mode`å¼ºåˆ¶ä¸º4ï¼Œæ­¤ç‰ˆæœ¬ä¸å¯é€‰æ‹©`cache_mode`ã€‚
    - ä¾‹ï¼š![Alt text](images/sr_example.png?raw=true "sr_example")

3. dissç¾¤å‹ `modules/cai.py`ï¼šä½¿ç”¨éšæœºè¯­å¥dissç¾¤å‹ã€‚
    - ä¾‹ï¼š![Alt text](images/cai_example.png?raw=true "cai_example")

## å¦‚ä½•éƒ¨ç½²
å› ä¸ºğŸŠå¤ªæ‡’ï¼Œè¿™éƒ¨åˆ†è¿˜æ²¡æœ‰å†™ã€‚

## ç‰¹åˆ«é¸£è°¢
æ„Ÿè°¢[sinceL](https://github.com/vayske)ä»¥åŠä»–çš„[sirius](https://github.com/vayske/sirius)å¯¹æœ¬é¡¹ç›®éƒ¨ç½²ä»¥åŠä»£ç ç¼–å†™çš„å¸®åŠ©ï¼
